<!DOCTYPE html> <html> <head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0"> <title>Utiliza npm v3.x sin la barra de progreso y obtendrás una instalación más rápida - Sergio Flores</title> <meta name="description" content=""> <meta name="viewport" content="width=device-width, initial-scale=1"> <meta name="theme-color" content="#0d47a1"> <link rel="canonical" href="https://byoigres.com/blog/2016/01/27/utiliza-npm-v3.x-sin-la-barra-de-progreso-y-obtendras-una-instalacion-mas-rapida/"> <link rel="alternate" type="application/rss+xml" title="Sergio Flores" href="https://byoigres.com/feed.xml"> <link rel="stylesheet" href="/assets/styles.css"> <script type="text/javascript"> var host = "byoigres.com"; if ((host == window.location.host) && (window.location.protocol != "https:")) window.location.protocol = "https"; </script> </head> <body> <div class="navbar-container"> <h1 class="logo"> <a href="/">Sergio Flores</a> </h1> <span class="hamburger"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path fill="#FFF" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/> <path fill="#FFF" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/> <path fill="#FFF" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/> </svg> </span> <ul class="navbar"> <li> <a href="/blog/" class="blog-link">Blog</a> </li> <li> <a href="/proyectos/" class="blog-link">Proyectos</a> </li> <li> <a href="/acerca-de-mi/" class="blog-link">Acerca de mi</a> </li> <li class="social"> <a href="https://twitter.com/byoigres" target="_blank"> <i class="fa fa-twitter" aria-hidden="true"></i> </a> <a href="https://facebook.com/byoigres" target="_blank"> <i class="fa fa-facebook" aria-hidden="true"></i> </a> <a href="https://github.com/byoigres" target="_blank"> <i class="fa fa-github" aria-hidden="true"></i> </a> <a href="http://stackoverflow.com/users/1301872/" target="_blank"> <i class="fa fa-stack-overflow" aria-hidden="true"></i> </a> <a href="mailto:byoigres@gmail.com" target="_blank"> <i class="fa fa-envelope" aria-hidden="true"></i> </a> <a href="/feed.xml" target="_blank"> <i class="fa fa-rss" aria-hidden="true"></i> </a> </li> </ul> </div> <script type="text/javascript"> var $ = document.querySelectorAll; var $$ = document.querySelector; var ham = document.querySelector('.hamburger'); ham.addEventListener('click', function() { var navbar = document.querySelector('.navbar'); if (navbar.classList.contains('display')) { navbar.classList.remove('display'); } else { navbar.classList.add('display'); } }) </script> <div class="content"> <article class="post" itemscope itemtype="http://schema.org/BlogPosting"> <header class="post-header"> <h1 class="post-title" itemprop="name headline">Utiliza npm v3.x sin la barra de progreso y obtendrás una instalación más rápida</h1> <p class="post-meta"> <time datetime="2016-01-27T06:02:00-07:00" itemprop="datePublished"> <i class="fa fa-calendar"></i> 27 de Enero de 2016 </time> <span> </span> <span itemprop="author" itemscope itemtype="http://schema.org/Person"> <i class="fa fa-user"></i> <span itemprop="name">Sergio Flores</span> </span> </p> </header> <div class="post-content" itemprop="articleBody"> <p class="center-image"><img src="/images/posts/npm-progress-bar-twitter.png" alt="No es margin ni padding" /></p> <p>Cada que ejecutamos un comando <code class="highlighter-rouge">npm install</code> con la versión 3 de npm podemos ver una bonita barra de progreso que nos dice el porcentaje que lleva la instalación de las dependencias que estamos instalando.</p> <p>Con o sin barra de progreso <a href="https://www.npmjs.com/package/npm">npm</a> se ha vuelto más lento desde la salida de la versión 3. Tanto así que desde hace algún tiempo alguién ha creado una versión alternativa para manejar los paquetes de node.js llamada <a href="http://gugel.io/ied/">ied</a> con el objetivo de obtener un mayor rendimiento.</p> <p>Seamos claros, <code class="highlighter-rouge">npm install</code> es el comando que con mayor frecuencia utilizamos, por lo menos deberia hacerlo bien ¿o no?</p> <p>Vamos a realizar un ejemplo instalando una cantidad significativa de dependencias utilizando y no la barra de progreso. El listado de dependencias es el siguiente:</p> <figure class="highlight"><pre><code class="language-json" data-lang="json"><span class="p">{</span><span class="w">
  </span><span class="nt">"assets-webpack-plugin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.2.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"babel-cli"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.4.5"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"babel-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.2.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"babel-preset-es2015"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.3.13"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"babel-preset-react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.3.13"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"classnames"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.2.3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"clean-webpack-plugin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.1.6"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"css-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.23.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"eslint"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.10.3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"eslint-config-airbnb"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"eslint-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.2.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"eslint-plugin-react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.16.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"extract-text-webpack-plugin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"flexbox-grid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"flexboxgrid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^6.3.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"h2o2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^5.0.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"hapi"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^12.1.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"hapi-webpack-plugin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.3.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"history"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.17.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"html-webpack-plugin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.7.2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"inert"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.2.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"isomorphic-fetch"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.2.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"node-sass"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.4.2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.14.6"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react-dom"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.14.6"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react-flexbox-grid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.9.2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react-hot-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.3.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react-redux"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^4.0.6"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"react-router"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"redux"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.0.6"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"redux-router"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.0-beta7"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"redux-thunk"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.0.3"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"sass-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^3.1.2"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"strip-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.1.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"style-loader"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^0.13.0"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"webpack"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.12.12"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"webpack-dev-server"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^1.14.1"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"webpack-hot-middleware"</span><span class="p">:</span><span class="w"> </span><span class="s2">"^2.6.2"</span><span class="w">
</span><span class="p">}</span></code></pre></figure> <p>Tomaremos el tiempo en cada ejecución y veremos que existe un ligero rendimiento al instalar las dependencias sin mostrar la barra de progreso.</p> <script type="text/javascript" src="https://asciinema.org/a/34946.js" id="asciicast-34946" async=""></script> <p>Con barra de progreso: 3 minutos con 8 segundos, sin barra de progreso <strong>2 minutos con 44 segundos</strong>, esto es un 12% mas rápido.</p> <p>Toda esta controversia nacio de un <a href="https://github.com/npm/npm/issues/8826#issuecomment-155762361">comentario en un issue en github</a> en donde el usuario <a href="https://github.com/andrenarchy">@andrenarchy</a> publica lo siguiente:</p> <figure class="highlight"><pre><code class="language-sh" data-lang="sh"><span class="gp">$ </span>npm <span class="nb">set </span><span class="nv">progress</span><span class="o">=</span><span class="nb">false</span>
<span class="gp">$ </span>rm -rf node_modules
<span class="gp">$ </span><span class="nb">time </span>npm install
<span class="o">[</span>...]
real    5m10.601s
user    4m56.435s
sys 0m36.003s

<span class="gp">$ </span>npm <span class="nb">set </span><span class="nv">progress</span><span class="o">=</span><span class="nb">true</span>
<span class="gp">$ </span>rm -rf node_modules
<span class="gp">$ </span><span class="nb">time </span>npm install
<span class="o">[</span>...]
real    21m13.415s
user    20m36.752s
sys 0m42.010s</code></pre></figure> <p>¡Sin mostrar la barra de progreso reducimos el tiempo de instalación de <strong>21 minutos con 13 segundos</strong> a <strong>5 minutos con 10 segundos</strong>!</p> <p>Esa instalación probablemente contiene muchas dependencias, pero inclusive en el <a href="https://twitter.com/gavinjoyce/status/691773956144119808">tweet que Gavin Joyce publicó</a> mostrando el mismo ejemplo, el tiempo de instalación de las dependencias se redujo considerablemente de <strong>3 minutos con 35 segundos</strong> a <strong>1 minuto con 53</strong>.</p> <blockquote class="twitter-tweet" lang="en"><p lang="en" dir="ltr">It sounds crazy, but disabling npm&#39;s progress bar yields a 2x npm install speed improvement for me <a href="https://t.co/ChXxSepCBK">pic.twitter.com/ChXxSepCBK</a></p>&mdash; Gavin Joyce (@gavinjoyce) <a href="https://twitter.com/gavinjoyce/status/691773956144119808">January 26, 2016</a></blockquote> <blockquote> <p><strong>¿Qué está causando tal cosa?</strong></p> </blockquote> <p>Después de un genial y profundo analisis mostrado en los comentarios del issue <a href="https://github.com/npm/npm/issues/11283#issuecomment-175246823">#11283</a> por el usuario <a href="https://github.com/samccone">@samccone</a> nos percatamos de que hay una problema en el paquete <a href="https://github.com/iarna/gauge">gauge</a> al momento de llamar la función <code class="highlighter-rouge">show</code>, y como el mundo del Open Source es impresionante basto con unas pocas horas para que alguien llegara con una <a href="https://github.com/iarna/gauge/commit/a7ab9c906bb72aa0ed8996a00db2cd35a22d5992">solución</a>.</p> <blockquote class="twitter-tweet" data-conversation="none" lang="en"><p lang="en" dir="ltr"><a href="https://twitter.com/softwarefloyd">@softwarefloyd</a> <a href="https://twitter.com/gavinjoyce">@gavinjoyce</a> bug found and fixed!</p>&mdash; Laurie Voss (@seldo) <a href="https://twitter.com/seldo/status/692192238445711360">January 27, 2016</a></blockquote> <script async="" src="//platform.twitter.com/widgets.js" charset="utf-8"></script> <p>Esperemos que en los proximos <em>releases</em> de <em>npm</em> podamos disfrutar de este exelente cambio.</p> <div id="disqus_thread"></div> <script> var disqus_config = function () { this.language = "es"; this.page.url = "https://byoigres.com/blog/2016/01/27/utiliza-npm-v3.x-sin-la-barra-de-progreso-y-obtendras-una-instalacion-mas-rapida/"; this.page.identifier = "516cfd32f5acfcb3bb263c97de4fec0d"; }; (function() { var d = document, s = d.createElement('script'); s.src = 'https://byoigres.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); </script> <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript> </div> </article> </div> <script type="text/javascript" src="/assets/app.js"></script> </body> </html>
